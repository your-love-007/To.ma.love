<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Birthday Surprise</title>
    <style>
        body {
            background: linear-gradient(135deg, #ffb6c1 0%, #e0f7e0 100%);
            color: #004d00;
            font-family: 'Arial', sans-serif;
            text-align: center;
            overflow: hidden;
            margin: 0;
            padding: 0;
            min-height: 100vh;
            border: 15px solid transparent;
            border-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect width="100" height="100" fill="none" stroke="%23ff66b3" stroke-width="5" stroke-dasharray="5,5"/><path d="M20,20 Q30,10 40,20 T60,20 T80,20" fill="none" stroke="%23ff1493" stroke-width="2"/><circle cx="15" cy="15" r="3" fill="%23ff66b3"/><circle cx="85" cy="15" r="3" fill="%23ff66b3"/><circle cx="15" cy="85" r="3" fill="%23ff66b3"/><circle cx="85" cy="85" r="3" fill="%23ff66b3"/></svg>') 30 round;
            box-sizing: border-box;
        }

        #question {
            margin-top: 20%; font-size: 2em; animation: fadeIn 2s ease-in-out;
            text-shadow: 2px 2px 4px rgba(255,255,255,0.7); position: relative; z-index: 100;
        }
        @keyframes fadeIn { 0% { opacity: 0; } 100% { opacity: 1; } }

        .button {
            padding: 12px 25px; font-size: 1.5em; margin: 20px; cursor: pointer;
            border: none; border-radius: 30px;
            background: linear-gradient(45deg, #ff66b3, #ff1493); color: white;
            animation: bounce 2s infinite;
            box-shadow: 0 5px 15px rgba(255,102,179,0.4);
            transition: all 0.3s ease; position: relative; z-index: 100;
        }
        .button:hover { transform: scale(1.05); box-shadow: 0 8px 20px rgba(255,102,179,0.6); }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }

        #nickname-container {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            overflow: hidden; z-index: 5; pointer-events: none;
        }
        .nickname {
            position: absolute; font-size: 2.2em; /* Slightly reduced to help with clustering */
            font-weight: bold;
            color: #d81b60; text-shadow: 1px 1px 3px rgba(255,255,255,0.7);
            animation: floatUp 7s linear forwards;
            bottom: -60px; /* Start slightly lower */
            opacity: 0; pointer-events: none;
            white-space: nowrap; /* Prevent wrapping if nickname is long */
        }
        @keyframes floatUp { 
            0% { transform: translateY(0) scale(0.8); opacity: 0;} /* Start smaller */
            10% { opacity: 0.9; transform: translateY(-10vh) scale(1); } /* Fade in and grow */
            90% { opacity: 0.9; transform: translateY(-90vh) scale(1); }
            100% { transform: translateY(-100vh) scale(0.8); opacity: 0;} /* Fade out and shrink */
        }

        /* Common styles for modal-like sections (except finalSection) */
        #birthdayMessage, #smallParagraphs, #hugeParagraph, #loveAnimation {
            display: none; /* All start hidden, JS will show them */
            position: fixed;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%); /* Center on screen */
            z-index: 50;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 2px solid rgba(255,102,179,0.3);
            box-shadow: 0 10px 30px rgba(255,102,179,0.2);
            box-sizing: border-box;
        }

        #birthdayMessage { /* Specific to birthdayMessage */
            animation: slideIn 1s ease-in-out;
            padding: 30px; padding-bottom: 80px; /* Space for its own next button */
            max-width: 80%;
        }
        @keyframes slideIn { 0% { transform: translate(-50%, -100%); } 100% { transform: translate(-50%, -50%); } }

        #smallParagraphs { /* Specific to smallParagraphs */
            width: 80%; max-width: 800px; text-align: left;
            animation: fadeIn 1s ease-in-out; 
            padding: 25px; padding-bottom: 80px; /* Space for its own next button */
        }
        .left-paragraphs, .right-paragraphs { width: 45%; display: inline-block; vertical-align: top; margin: 10px; }
        .left-paragraphs { text-align: left; } .right-paragraphs { text-align: right; }
        .paragraph { margin-bottom: 15px; line-height: 1.5; color: #333; text-shadow: 1px 1px 2px rgba(255,255,255,0.5); }

        /* === #hugeParagraph - THE SCROLLABLE SECTION === */
        #hugeParagraph { /* This is the main modal container */
            width: 80%; max-width: 800px; max-height: 80vh; 
            animation: slideIn 1s ease-in-out;
            
            overflow-y: auto; /* The container itself scrolls if content is too long */
            padding: 30px; /* Padding for the text content */
            padding-bottom: 100px; /* CRITICAL: Space at the bottom for the button to sit in */
            
            color: #333; font-size: 1.4em; 
            text-align: center; line-height: 1.6;
        }
        #hugeParagraph p { /* Ensure the <p> tag inside doesn't have extra margins */
            margin: 0; 
            padding: 0;
        }

        /* Button within #hugeParagraph */
        #hugeParagraph .next-button { /* Targets #nextButton3 specifically */
            position: absolute; /* Relative to #hugeParagraph */
            bottom: 99px; /* Positioned within the padding-bottom of #hugeParagraph */
            left: 50%;
            transform: translateX(-50%); /* Horizontally center */
            
            opacity: 0; /* Initially hidden */
            pointer-events: none;
            transition: opacity 0.5s ease-in-out;
            
            margin: 0; /* Override general .button margin */
            animation: none; /* Override the general bounce animation for this specific button */
            z-index: 51; 
        }
         #hugeParagraph .next-button.visible {
            opacity: 1;
            pointer-events: auto;
        }


        /* === #loveAnimation Section === */
        #loveAnimation {
            display: none; /* JS sets to flex */
            flex-direction: column; align-items: center; justify-content: center;
            font-weight: 800; color: #ff66b3; text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
            animation: loveAppear 1.5s ease-out forwards, pulse 2s infinite 1.5s;
            width: 90%; max-width: 650px; 
            text-align: center; padding: 30px 20px; padding-bottom: 100px; /* Space for its button */
            background: rgba(255, 255, 255, 0.3); 
            backdrop-filter: blur(7px); 
            border-radius: 30px; 
            box-shadow: 0 12px 40px rgba(255,102,179,0.4);
            overflow: hidden; 
        }
        @keyframes loveAppear { 0% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); } 100% { opacity: 1; transform: translate(-50%, -50%) scale(1); } }
        @keyframes pulse { 0%, 100% { transform: translate(-50%, -50%) scale(1); } 50% { transform: translate(-50%, -50%) scale(1.03); } }
        #animatedLoveTextContainer { margin-bottom: 20px; font-size: 1.9em; font-weight: bold; color: #e91e63; position: relative; z-index: 2; }
        .love-char { display: inline-block; opacity: 0; transform: translateY(25px); animation: revealChar 0.6s forwards; text-shadow: 1px 1px 0px rgba(255,255,255,0.5); }
        @keyframes revealChar { to { opacity: 1; transform: translateY(0); text-shadow: 1px 1px 0px rgba(255,255,255,0.5), 0 0 8px #fff, 0 0 15px #ff80ab, 0 0 25px #ff80ab; } }
        #animatedCake { font-size: 4.2em; opacity: 0; transform: scale(0.5); animation: popIn 0.8s cubic-bezier(0.68, -0.55, 0.27, 1.55) forwards; animation-delay: 2.3s; text-shadow: 0 0 15px #ffc107, 0 0 25px #ff9800; position: relative; z-index: 2; margin-bottom: 10px; }
        #pulsingHeartSymbol { font-size: 3.8em; color: #ff4081; opacity: 0; animation: heartPulseSimple 1.5s infinite, popIn 0.8s ease-out forwards; animation-delay: 2.9s; text-shadow: 0 0 10px #fff, 0 0 20px #ff4081; position: relative; z-index: 2; }
        @keyframes popIn { 0% { opacity: 0; transform: scale(0.5); } 100% { opacity: 1; transform: scale(1); } }
        @keyframes heartPulseSimple { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.15); } }
        .falling-love-heart { position: absolute; top: -50px; font-size: 1.8em; color: #ff80ab; opacity: 0; animation: fallAndFade 7s linear infinite; user-select: none; pointer-events: none; z-index: 1; }
        @keyframes fallAndFade { 0% { transform: translateY(0vh) rotate(var(--r-start, 0deg)); opacity: 0.9; } 100% { transform: translateY(115vh) rotate(var(--r-end, 360deg)); opacity: 0; } }
        .glowing-orb { position: absolute; border-radius: 50%; opacity: 0; animation-name: glowAndDriftEnhanced; animation-timing-function: ease-in-out; animation-iteration-count: infinite; pointer-events: none; z-index: 0; }
        @keyframes glowAndDriftEnhanced { 0%, 100% { opacity: 0; transform: translate(var(--tx-start), var(--ty-start)) scale(0.7) rotate(var(--r-start)); } 20% { opacity: 0.4; } 50% { opacity: 0.6; transform: translate(var(--tx-mid), var(--ty-mid)) scale(1) rotate(var(--r-mid)); } 80% { opacity: 0.3; } }

        /* General .next-button style for popups (birthdayMessage, smallParagraphs, loveAnimation) */
        .next-button { /* This applies to nextButton1, nextButton2, nextButton4 */
            position: absolute; 
            bottom: 25px; 
            right: 25px;  
            z-index: 100; 
            margin: 0; 
        }
        /* Note: #hugeParagraph .next-button has its own specific styles above, making it centered at the bottom */

        #loveAnimation .next-button { opacity: 0; animation: fadeInButton 0.5s ease-in 4.2s forwards; }
        @keyframes fadeInButton { 0% { opacity: 0; } 100% { opacity: 1; } }
        
        /* This class is added to each modal for context, if needed, but .next-button positioning is handled above */
        .message-container { position: relative; } 

        /* === Final Section - ENSURE FULL SCREEN AND NO TRANSFORM === */
        #finalSection {
            display: none; /* Starts hidden, JS will show it */
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%;
            transform: none !important; /* CRITICAL: Ensure no unwanted transform from other modals */
            background: linear-gradient(135deg, #ffb6d9 0%, #c8f7c5 100%);
            z-index: 60; 
            overflow-y: auto; 
            padding: 40px 20px;
            box-sizing: border-box;
        }
        .para-box { background-color: rgba(255,255,255,0.85); border-radius: 15px; padding: 30px; margin: 25px auto; max-width: 700px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); border: 3px solid #ff66b3; position: relative; transition: all 0.3s ease; box-sizing: border-box; }
        .para-box:hover { transform: translateY(-5px); box-shadow: 0 15px 30px rgba(0,0,0,0.15); }
        .para-box::before { content: ""; position: absolute; top: 0; left: 0; right: 0; height: 8px; background: linear-gradient(90deg, #ff66b3, #ffcc00, #66ccff, #ff6666, #cc66ff); border-radius: 15px 15px 0 0; }
        .para-box h2 { color: #d81b60; margin-top: 0; position: relative; padding-bottom: 10px; }
        .para-box h2::after { content: ""; position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 100px; height: 3px; background: linear-gradient(90deg, transparent, #ff66b3, transparent); }

        /* Decorative elements */
        .balloon, .bulb, .confetti, .floating-heart, .sparkle { position: absolute; pointer-events: none; }
        .balloon { width: 60px; height: 80px; border-radius: 50%; animation: balloonFloat 8s linear infinite; bottom: -100px; z-index: 10; opacity: 0.8;}
        @keyframes balloonFloat { 0% { transform: translateY(0) rotate(0deg); opacity: 0.8; } 100% { transform: translateY(-120vh) rotate(360deg); opacity: 0; }}
        .bulb { width: 25px; height: 25px; border-radius: 50%; animation: blink 1.5s infinite alternate; z-index: 10; filter: drop-shadow(0 0 5px currentColor);}
        @keyframes blink { 0% { opacity: 0.4; transform: scale(0.9); } 100% { opacity: 1; transform: scale(1.1); }}
        .confetti { width: 12px; height: 12px; opacity: 0.7; animation: confettiFall 5s linear infinite; z-index: 10;}
        @keyframes confettiFall { 0% { transform: translateY(-100vh) rotate(0deg); opacity: 1; } 100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }}
        .floating-heart { font-size: 1.8em; color: #ff66b3; animation: floatHeart 10s linear infinite; z-index: 10; opacity: 0.7;}
        @keyframes floatHeart { 0% { transform: translateY(100vh) rotate(0deg); opacity: 0; } 20% { opacity: 0.7; } 80% { opacity: 0.7; } 100% { transform: translateY(-100vh) rotate(360deg); opacity: 0; }}
        .sparkle { width: 5px; height: 5px; background-color: gold; border-radius: 50%; animation: sparkleTwinkle 2s infinite alternate; z-index: 10;}
        @keyframes sparkleTwinkle { 0% { opacity: 0.2; transform: scale(0.5); } 100% { opacity: 1; transform: scale(1.2); }}

    </style>
</head>
<body>

<div id="bulbs"></div>
<div id="balloons"></div>
<div id="confetti-container"></div>
<div id="hearts-container"></div>
<div id="sparkles-container"></div>

<div id="question">
    <p>Do you love me?</p>
    <button class="button" id="yesButton">Yes</button>
    <button class="button" id="noButton">No</button>
</div>

<div id="nickname-container"></div>

<div id="birthdayMessage" class="message-container">
    <h1>Happy Birthday, My Love! üéÇ</h1>
    <p>You are my everything, my princess, my cheesecake, my jaan, my darling, my sweetheart, my love, my baby, my kucchhuuu pucchuu, my bongi, my wifey. I am so lucky to have you in my life. Happy Birthday, my love!</p>
    <button class="button next-button" id="nextButton1">Next</button>
</div>

<div id="smallParagraphs" class="message-container">
    <div class="left-paragraphs">
        <div class="paragraph">
            <p>Your laugh, your giggles, your goofyness truly keeps me alive, can't wait to hear it non-stop in our house. Your smile is literally black magic the way it pulled me in love with you... (ma favourite witch)üòÇ.</p>
        </div>
        <div class="paragraph">
            <p>I don't know what I would do without your magic in ma boring a** life. Life without you would literly be like a book with blank pages... useless. I pray for us and your success every day, Jaana... ILubu infinite times.Muwaaaa</p>
        </div>
    </div>
    <div class="right-paragraphs">
        <div class="paragraph">
            <p>Every moment with you feels like a dream, a dream I never want to wake up from... and You can't imagine how many dreams I've had of us being together... its crazy!! ..Enjoy your birthday; one day you'll enjoy it with me too, ameen.</p>
        </div>
        <div class="paragraph">
            <p>When writing this, the bake sale memory was playing in ma head constantly. What a day that was, ahhhhhh!! Although ma heart was racing and itni sharam arahi thi, but still, it was a once-in-a-lifetime moment!!</p>
            <p>Jaan, I really really really hope that our duaa gets accepted and we live a very happy, romantic, funny, supportive life together. HAPPY BIRTHDAY MY CHEESECAKE FROM YOUR SUNSHINE, HUSBANDnO, LOVE, BONGA, manhoos, beghairat.... CHANDAAüíó</p>
        </div>
    </div>
    <button class="button next-button" id="nextButton2">Next</button>
</div>

<div id="hugeParagraph" class="message-container"> 
    <p>MY LOVE,
I truly pray for your successful future with ME, and I hope you achieve everything you want in life which is beneficial for you.
Hamesha khush rahena jaan ‚Äî whether I am with you or not, whether I am on earth or not.
I love everything about you ‚Äî your personality, your appearance, your mindset, your morals and ethics‚Ä¶ literally everything.
You are the most beautiful woman inside out in this messed up world.
I love how you motivate me to work harder even when you are not talking to me ‚Äî making me do it for all the promises and that life with you in the future.
Thank you, seriously, for being in my life. In Sha Allah, our future will be together (ameen).
I love you‚Ä¶ MWAAAAAAAAAAA. I CAN'T WAIT TO HAVE YOU NEXT TO ME.
May our duaas get accepted; indeed, Allah never disappoints His believers.
But for now‚Ä¶
Happy birthday kucchuuu‚Ä¶ my everything, my princess, my jaan, my darling, my sweetheart, my cheesecake, my love, my baby, my kucchhuuu pucchuu, my bongi, my wifey.
I am so lucky to have you in my life. 
Happy Birthday, Jaana (I tried my best to make it look the best, but still, it isn't perfect, sorryyy) ‚ù§Ô∏èBut I can guarantee my love for you is a hundred percent the best from my side.
I‚Äôll always love you ‚Äî Meri dil ki dharkan, jaan-e-mann‚Ä¶
</p>
    <button class="button next-button" id="nextButton3">Next</button> 
</div>

<div id="loveAnimation" class="message-container">
    <div id="animatedLoveTextContainer">
        <span class="love-char">H</span><span class="love-char">a</span><span class="love-char">p</span><span class="love-char">p</span><span class="love-char">y</span>
        <span class="love-char">¬†</span>
        <span class="love-char">B</span><span class="love-char">i</span><span class="love-char">r</span><span class="love-char">t</span><span class="love-char">h</span><span class="love-char">d</span><span class="love-char">a</span><span class="love-char">y</span>
        <br>
        <span class="love-char">M</span><span class="love-char">y</span>
        <span class="love-char">¬†</span>
        <span class="love-char">L</span><span class="love-char">o</span><span class="love-char">v</span><span class="love-char">e</span>
        <span class="love-char">!</span>
    </div>
    <div id="animatedCake">üéÇ</div>
    <div id="pulsingHeartSymbol">‚ù§Ô∏è</div>
    <button class="button next-button" id="nextButton4">Next</button>
</div>

<div id="finalSection">
    <div class="para-box">
        <h2>My only wife</h2>
        <p> you'll always be my one and only wife Insha'Allah you're more then enough for me, never ever think that i'll ever choose someone over you. I'll never forget you thats a bond promise. muwaa  </p>
    </div>
    <div class="para-box">
        <h2>Me-a proud sniper</h2>
        <p>I have told you before to but its not enough.. I still can't believe how i got you as my wifey- Masha'Allah not only you're beautiful from the outside but he inside toooo, from that cute face, mezmorizing eyes, and those sweet lipsü§åüèª to your mindset, emotional intelligence, thinking pattern and having mindfulness and clarity is something for which i can't express enough words. I seriously serious love you!</p>
    </div>
    <div class="para-box">
        <h2>Best Memories</h2>
        <p> From seeing slay on your story, making you giggle in the open house, the start of bio talks, that subtle hint in starting time, the ribbon you gave me from your hand, sitting close to you(the challenge), your cake that you made, when i got to know that you also saved dates, THE BAKE SALE, when you send me yo pics(Masha'Allah my gorgeous), and every I love you, kisses and vms, to deep talks and some disagreements and arguments, Every memory we've created together, from the silly moments to the deep conversations, has become a treasure I hold close to my heart. .</p>
    </div>
    <div class="para-box">
        <h2>Our Future Together</h2>
        <p>I dream of our future - building a life together filled with love, laughter, and mutual growth. With you by my side, I know it won't be easy but we are doing for the sake of Allah so I'm sure He will reunite us, we don't know when but I trust Allah's every plan adn decision that is taken place. Always be hopefull from Allah and be close to Him and never think He is not with you  </p>
    </div>
</div>

<script>
    // ========== UPDATED NICKNAMES LIST ==========
    const nicknames = [
        "Princess", "Jaana", "Cheesecake", "Jaan", 
        "Darling", "Wifey", "Sweetheart", "Bongi"
    ];
    // =============================================

    const loveStatements = ["Are you sure?", "Think about it...", "Don't do this to me...", "Please reconsider...", "You mean the world to me...", "I can't imagine life without you...", "You're my everything...", "Think again, jaan...", "You're my sunshine...", "You make my heart smile..."];
    let loveIndex = 0;
    let nicknameInterval;
    let isNicknameAnimationActive = false;


    document.addEventListener('DOMContentLoaded', function() {
        createDecorations();
        setupEventListeners();
    });

    function createDecorations() {
        const balloonColors = ["#ff66b3", "#ffcc00", "#66ccff", "#ff6666", "#cc66ff"]; const bulbColors = ["#ff6666", "#66ff66", "#6666ff", "#ffcc00", "#cc66ff"]; const confettiColors = ["#ff66b3", "#ff1493", "#66ccff", "#ffcc00", "#ff6666"];
        for (let i = 0; i < 30; i++) { setTimeout(() => { const balloon = document.createElement('div'); balloon.className = 'balloon'; balloon.style.left = `${Math.random() * 100}%`; balloon.style.backgroundColor = balloonColors[Math.floor(Math.random() * balloonColors.length)]; balloon.style.animationDuration = `${Math.random() * 8 + 6}s`; balloon.style.animationDelay = `${Math.random() * 5}s`; document.getElementById('balloons').appendChild(balloon); }, i * 300); }
        for (let i = 0; i < 30; i++) { const bulb = document.createElement('div'); bulb.className = 'bulb'; bulb.style.left = `${Math.random() * 100}%`; bulb.style.top = `${Math.random() * 100}%`; bulb.style.backgroundColor = bulbColors[Math.floor(Math.random() * bulbColors.length)]; bulb.style.animationDuration = `${Math.random() * 1.5 + 0.5}s`; bulb.style.animationDelay = `${Math.random() * 2}s`; document.getElementById('bulbs').appendChild(bulb); }
        for (let i = 0; i < 80; i++) { const confetti = document.createElement('div'); confetti.className = 'confetti'; confetti.style.left = `${Math.random() * 100}%`; confetti.style.backgroundColor = confettiColors[Math.floor(Math.random() * confettiColors.length)]; confetti.style.animationDuration = `${Math.random() * 4 + 3}s`; confetti.style.animationDelay = `${Math.random() * 5}s`; confetti.style.width = `${Math.random() * 10 + 5}px`; confetti.style.height = `${Math.random() * 10 + 5}px`; confetti.style.borderRadius = `${Math.random() * 50}%`; document.getElementById('confetti-container').appendChild(confetti); }
        for (let i = 0; i < 20; i++) { const heart = document.createElement('div'); heart.className = 'floating-heart'; heart.innerHTML = '‚ù§Ô∏è'; heart.style.left = `${Math.random() * 100}%`; heart.style.animationDuration = `${Math.random() * 15 + 10}s`; heart.style.animationDelay = `${Math.random() * 10}s`; heart.style.fontSize = `${Math.random() * 2 + 1.5}em`; document.getElementById('hearts-container').appendChild(heart); }
        for (let i = 0; i < 50; i++) { const sparkle = document.createElement('div'); sparkle.className = 'sparkle'; sparkle.style.left = `${Math.random() * 100}%`; sparkle.style.top = `${Math.random() * 100}%`; sparkle.style.animationDuration = `${Math.random() * 2 + 1}s`; sparkle.style.animationDelay = `${Math.random() * 3}s`; document.getElementById('sparkles-container').appendChild(sparkle); }
    }

    function setupEventListeners() {
        document.getElementById('yesButton').addEventListener('click', () => handleResponse('yes'));
        document.getElementById('noButton').addEventListener('click', () => handleResponse('no'));
        
        document.getElementById('nextButton1').addEventListener('click', () => {
            stopNicknameAnimation(); // Stop nicknames when leaving birthdayMessage
            document.getElementById('birthdayMessage').style.display = 'none'; 
            document.getElementById('smallParagraphs').style.display = 'block'; 
        });
        
        document.getElementById('nextButton2').addEventListener('click', () => {
            document.getElementById('smallParagraphs').style.display = 'none';
            const hugeParagraphModal = document.getElementById('hugeParagraph');
            const nextButton3 = hugeParagraphModal.querySelector('#nextButton3');

            hugeParagraphModal.style.display = 'block'; // Show the modal. It's scrollable due to CSS.

            function checkScrollHugeParagraph() {
                const scrollBuffer = 15; 
                if (hugeParagraphModal.scrollHeight - hugeParagraphModal.scrollTop <= hugeParagraphModal.clientHeight + scrollBuffer) { 
                    nextButton3.classList.add('visible');
                } else {
                     nextButton3.classList.remove('visible'); 
                }
            }
            checkScrollHugeParagraph(); 
            hugeParagraphModal.addEventListener('scroll', checkScrollHugeParagraph); 
        });
        
        document.getElementById('nextButton3').addEventListener('click', () => {
            document.getElementById('hugeParagraph').style.display = 'none';
            const loveAnimationSection = document.getElementById('loveAnimation');
            loveAnimationSection.style.display = 'flex'; 

            const chars = loveAnimationSection.querySelectorAll('#animatedLoveTextContainer .love-char');
            chars.forEach((char, index) => { char.style.animationDelay = `${index * 0.12}s`; });
            
            createFallingLoveHearts(loveAnimationSection, 30);
            createGlowingOrbs(loveAnimationSection, 18);
        });
        
        document.getElementById('nextButton4').addEventListener('click', () => {
            document.getElementById('loveAnimation').style.display = 'none';
            const finalSectionEl = document.getElementById('finalSection');
            finalSectionEl.style.display = 'block'; 
            finalSectionEl.style.transform = 'none'; 
            addFinalEffects();
        });
    }

    function handleResponse(response) {
        const questionDiv = document.getElementById('question');
        if (response === 'no') {
            if (loveIndex < loveStatements.length) {
                questionDiv.innerHTML = `<p>${loveStatements[loveIndex]}</p><button class="button" id="yesButtonNew">Yes</button><button class="button" id="noButtonNew">No</button>`;
                loveIndex++;
                questionDiv.querySelector('#yesButtonNew').addEventListener('click', () => handleResponse('yes'));
                questionDiv.querySelector('#noButtonNew').addEventListener('click', () => handleResponse('no'));
            } else {
                questionDiv.innerHTML = `<p>I'll keep asking until you say Yes!</p><button class="button" id="yesButtonFinal">Yes</button>`;
                questionDiv.querySelector('#yesButtonFinal').addEventListener('click', () => handleResponse('yes'));
            }
        } else if (response === 'yes') {
            questionDiv.style.display = 'none';
            startNicknameAnimation(); 
            // Show birthday message after a short delay to let some nicknames appear
            setTimeout(() => {
                document.getElementById('birthdayMessage').style.display = 'block';
            }, 500); 
        }
    }

    function startNicknameAnimation() {
        if (isNicknameAnimationActive) return; // Prevent multiple intervals
        isNicknameAnimationActive = true;
        // Create initial batch of nicknames
        for (let i = 0; i < 5; i++) { // Reduced initial batch
            setTimeout(createNickname, i * 400); // Slower initial creation
        }
        nicknameInterval = setInterval(createNickname, 800); // Slower continuous creation
    }

    function stopNicknameAnimation() {
        isNicknameAnimationActive = false;
        clearInterval(nicknameInterval);
        const nicknameContainer = document.getElementById('nickname-container');
        // Remove all child elements (nicknames) from the container
        while (nicknameContainer.firstChild) {
            nicknameContainer.removeChild(nicknameContainer.firstChild);
        }
    }

    function createNickname() {
        if (!isNicknameAnimationActive) return; // Stop creating if animation is no longer active

        const colors = ["#d81b60", "#ff1493", "#c71585", "#ff69b4", "#db7093"];
        const nicknameEl = document.createElement('div'); 
        nicknameEl.className = 'nickname';
        nicknameEl.textContent = nicknames[Math.floor(Math.random() * nicknames.length)];
        nicknameEl.style.color = colors[Math.floor(Math.random() * colors.length)];
        
        // Try to position more sparsely
        let randomLeft = Math.random() * 70 + 15; // % from 15% to 85%
        nicknameEl.style.left = `${randomLeft}%`; 
        nicknameEl.style.animationDelay = `${Math.random() * 0.5}s`; // Slight random start delay

        document.getElementById('nickname-container').appendChild(nicknameEl);
        
        setTimeout(() => { 
            if (nicknameEl.parentNode) nicknameEl.remove(); 
        }, 7000); // Corresponds to animation duration
    }

    function createFallingLoveHearts(containerElement, count) {
        const heartEmojis = ['üíñ', 'üíï', 'üíû', 'üíì', 'üíó', '‚ù§Ô∏è'];
        for (let i = 0; i < count; i++) {
            setTimeout(() => {
                const heart = document.createElement('div'); heart.className = 'falling-love-heart';
                heart.textContent = heartEmojis[Math.floor(Math.random() * heartEmojis.length)];
                heart.style.left = `${Math.random() * 92 + 4}%`; heart.style.animationDuration = `${Math.random() * 4 + 6}s`; 
                heart.style.animationDelay = `${Math.random() * 6}s`; heart.style.fontSize = `${Math.random() * 0.7 + 1.3}em`; 
                heart.style.setProperty('--r-start', `${Math.random() * 120 - 60}deg`); heart.style.setProperty('--r-end', `${Math.random() * 360 - 180}deg`);
                containerElement.appendChild(heart);
                heart.addEventListener('animationend', () => { if (heart.parentNode) heart.remove(); });
            }, i * 180); 
        }
    }

    function createGlowingOrbs(containerElement, count) {
        const orbColors = ['rgba(255, 182, 193, 0.5)', 'rgba(255, 105, 180, 0.45)', 'rgba(255, 230, 235, 0.6)', 'rgba(221, 160, 221, 0.55)', 'rgba(255, 170, 200, 0.5)'];
        for (let i = 0; i < count; i++) {
            setTimeout(() => {
                const orb = document.createElement('div'); orb.className = 'glowing-orb';
                orb.style.width = orb.style.height = `${Math.random() * 70 + 40}px`;
                orb.style.backgroundColor = orbColors[Math.floor(Math.random() * orbColors.length)];
                orb.style.left = `${Math.random() * 90}%`; orb.style.top = `${Math.random() * 85}%`; 
                orb.style.animationDuration = `${Math.random() * 6 + 8}s`; orb.style.animationDelay = `${Math.random() * 5}s`;
                orb.style.setProperty('--tx-start', `${Math.random() * 60 - 30}px`); orb.style.setProperty('--ty-start', `${Math.random() * 50 - 25}px`);
                orb.style.setProperty('--r-start', `${Math.random() * 180 - 90}deg`); orb.style.setProperty('--tx-mid', `${Math.random() * 80 - 40}px`);
                orb.style.setProperty('--ty-mid', `${Math.random() * 70 - 35}px`); orb.style.setProperty('--r-mid', `${Math.random() * 360 - 180}deg`);
                containerElement.appendChild(orb);
            }, i * 250);
        }
    }

    function addFinalEffects() {
        const finalSection = document.getElementById('finalSection');
        for (let i = 0; i < 15; i++) { const heart = document.createElement('div'); heart.className = 'floating-heart'; heart.innerHTML = '‚ù§Ô∏è'; heart.style.left = `${Math.random() * 100}%`; heart.style.animationDuration = `${Math.random() * 12 + 8}s`; heart.style.animationDelay = `${Math.random() * 5}s`; heart.style.fontSize = `${Math.random() * 2 + 1.5}em`; finalSection.appendChild(heart); }
        for (let i = 0; i < 30; i++) { const sparkle = document.createElement('div'); sparkle.className = 'sparkle'; sparkle.style.left = `${Math.random() * 100}%`; sparkle.style.top = `${Math.random() * 100}%`; sparkle.style.animationDuration = `${Math.random() * 2 + 1}s`; sparkle.style.animationDelay = `${Math.random() * 3}s`; finalSection.appendChild(sparkle); }
    }

    // MUSIC PLAYER CODE
    window.addEventListener('DOMContentLoaded', () => {
        const audio = new Audio('iradey.mp3'); // upload this file to GitHub in the same folder
        audio.loop = true;
        audio.volume = 0.8;

        const playBtn = document.createElement('button');
        playBtn.innerText = 'üéµ Play Music';
        playBtn.style.position = 'fixed';
        playBtn.style.bottom = '20px';
        playBtn.style.right = '20px';
        playBtn.style.padding = '12px 20px';
        playBtn.style.fontSize = '18px';
        playBtn.style.background = 'linear-gradient(to right, #ffb6c1, #ff69b4)';
        playBtn.style.border = 'none';
        playBtn.style.borderRadius = '30px';
        playBtn.style.boxShadow = '0 4px 12px rgba(255, 105, 180, 0.4)';
        playBtn.style.color = 'white';
        playBtn.style.cursor = 'pointer';
        playBtn.style.zIndex = '9999';
        playBtn.style.transition = 'transform 0.2s ease';
        playBtn.addEventListener('mouseenter', () => {
            playBtn.style.transform = 'scale(1.05)';
        });
        playBtn.addEventListener('mouseleave', () => {
            playBtn.style.transform = 'scale(1)';
        });

        playBtn.addEventListener('click', () => {
            if (audio.paused) {
                audio.play().catch(() => {
                    alert('Browser blocked autoplay. Tap the button again!');
                });
            }
        });

        document.body.appendChild(playBtn);

        // Try to autoplay
        audio.play().catch(() => {
            // Browser blocked it. Button will still work.
            console.log('Autoplay blocked. User interaction required.');
        });
    });
</script>
</body>
</html>
